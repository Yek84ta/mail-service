# مستندات پکیج احراز هویت کاربر

## معرفی

این پکیج امکانات احراز هویت کاربران را برای سرویس میل (Milo) فراهم می‌کند، شامل:

- ثبت نام کاربر
- ورود به سیستم
- مدیریت گذرواژه‌ها

## ساختار پکیج

```
aut.ap.user/
├── PasswordHasher.java      - مدیریت هش کردن و تأیید گذرواژه
├── User.java                - موجودیت کاربر در سیستم
├── UserRepository.java      - لایه دسترسی به داده‌های کاربر
├── UserService.java         - منطق کسب و کار کاربران
└── UserValidation.java      - ابزارهای اعتبارسنجی اطلاعات کاربر
```

## اجزای اصلی

### 1. PasswordHasher

مسئول هش کردن امن گذرواژه‌ها با استفاده از SHA-256 و نمک (salt).

**ویژگی‌ها:**
- تولید نمک تصادفی برای هر گذرواژه
- استفاده از الگوریتم SHA-256
- ذخیره نمک و هش به صورت ترکیبی (نمک:هش)
- امکان تأیید گذرواژه

### 2. موجودیت User

نمایش دهنده کاربر در سیستم با حاشیه‌نویسی‌های JPA برای ذخیره در پایگاه داده.

**فیلدها:**
- `id`: شناسه یکتا (تولید خودکار)
- `name`: نام کامل کاربر
- `email`: آدرس ایمیل یکتا (برای ورود به سیستم)
- `passwordHash`: گذرواژه هش شده با نمک

### 3. UserRepository

لایه دسترسی به داده‌ها برای عملیات کاربران.

**متدها:**
- `save()`: ذخیره کاربر جدید
- `findByEmail()`: یافتن کاربر با ایمیل
- `findById()`: یافتن کاربر با شناسه
- `existsByEmail()`: بررسی وجود ایمیل در سیستم

### 4. UserService

لایه منطق کسب و کار برای عملیات کاربران.

**عملکرد اصلی:**
- `registerUser()`: ثبت نام کاربر جدید
  - اعتبارسنجی ایمیل، گذرواژه و نام
  - بررسی تکراری نبودن ایمیل
  - هش کردن گذرواژه قبل از ذخیره
- `loginUser()`: احراز هویت کاربر
  - تأیید ایمیل و گذرواژه
  - برگرداندن کاربر در صورت تطابق
- `findByEmail()`: یافتن کاربر با ایمیل

### 5. UserValidation

اعتبارسنجی اطلاعات کاربر.

**قوانین اعتبارسنجی:**
- **ایمیل**:
  - نباید خالی باشد
  - باید قالب استاندارد ایمیل را داشته باشد
- **گذرواژه**:
  - حداقل ۸ کاراکتر
  - حداقل یک عدد
  - حداقل یک حرف کوچک
  - حداقل یک حرف بزرگ
- **نام**:
  - نباید خالی باشد


# HibernateUtil - ابزار اتصال به پایگاه داده با Hibernate

## توضیحات
این کلاس یک ابزار کمکی برای مدیریت اتصال به پایگاه داده با استفاده از Hibernate در برنامه‌های جاوا می‌باشد.

## ویژگی‌های کلیدی
- ایجاد و مدیریت `SessionFactory` به صورت Singleton
- پیکربندی خودکار از طریق فایل `hibernate.cfg.xml`
- مدیریت صحیح منابع با متد `shutdown()`
- خطایابی مناسب در صورت عدم موفقیت در ایجاد SessionFactory


## نکات مهم
- این کلاس به صورت thread-safe طراحی شده است.
- در برنامه‌های تحت وب، بهتر است از طریق Listener در زمان راه‌اندازی و توقف برنامه، متدهای مربوطه فراخوانی شوند.
- در صورت نیاز به پیکربندی پویا، می‌توان متد `buildSessionFactory()` را تغییر داد.

## نمونه فایل پیکربندی
فایل `hibernate.cfg.xml` باید شامل تنظیمات اتصال به پایگاه داده و ماپینگ موجودیت‌ها باشد.

